<!DOCTYPE html>
<html lang="en">
        <style type="text/css">
        /* Global font*/
        header {
            font: bold 34px sans-serif;
        }
        body {
            font: bold 15px sans-serif;
        }
        .axis path,
        .axis line {
                fill: none;
                stroke: black;
                shape-rendering: crispEdges;
                }

        </style>
    <head>
        <meta charset="utf-8">
        <title>2A</title>
        <script type="text/javascript" src="d3/d3.v3.js"></script>
    </head>
    
    <body>
        <header>Assignment 2A: One scatter plot and two datasets</header>
        <p> This is the visualization for exercise 2A showing the relationship between "PROSTITUTION and "VEHICLE THEFT" for the different districts.</p>
        <p id = "title" align = "center" style="font-size:200%"> Data 2003 </p>
        <div id="area1" align="center"></div>
        <p> Change the year by pressing the corresponding button </p>
        <input type="button" align="center" value="Data 2003" id="2003" onclick="draw_circles('visualization_2003.csv','2003');"/>
        <input type="button" align="center" value="Data 2015" id="2015" onclick="draw_circles('visualization_2015.csv','2015');"/>
        <p> The axis values are the same for both visualizations so that it is easier to compare the two datasets with a single click </p>

        <script type="text/javascript">
        var width = 1500;
        var height = 500;
        var xScale;
        var yScale;
        var padding = 100;
        var xAxis;
        var yAxis;
        var svg = d3.select("#area1")
                    .append("svg")
                    .attr("width",width)
                    .attr("height",height);

        d3.csv('visualization_2003.csv', function(data) {
            data.forEach( function(d){
                d.District = d.District;
                d.NoPros = +d.NoPros;
                d.NoVehicle = +d.NoVehicle;
                d.Radius = +d.Radius;
            })
            
            //Making x- and y-scales
            xScale = d3.scale.linear()
                .domain([0-padding*0.5, d3.max(data, function(d) { return d.NoPros; })])
                .range([padding, width - padding*2]);
                     
            yScale = d3.scale.linear()
                .domain([0, d3.max(data, function(d) { return d.NoVehicle ; })+padding*4])
                .range([height - padding, padding]);

            //Defining X axis
            xAxis = d3.svg.axis()
                        .scale(xScale)
                        .orient("bottom");


            //Defining Y axis
            yAxis = d3.svg.axis()
                        .scale(yScale)
                        .orient("left");


            //Drawing circles
            svg.selectAll("circle")
                .data(data)
                .enter()
                .append("circle")
                .attr("r",function(d){
                    return d.Radius*2;
                 })
                .attr("cx",function(d){
                     return xScale(d.NoPros);
                 })
                .attr("cy",function(d){
                    return yScale(d.NoVehicle);
                 })
				  .attr("fill", "pink");
				  ;

            svg.selectAll("text")
                .data(data)
                .enter()
                .append("text")
                .text(function(d) {
                    return d.District;
                })
                .attr("x", function(d) {
                    return xScale(d.NoPros);
                 })
                .attr("y", function(d) {
                    return yScale(d.NoVehicle);
                 })
                .attr("font-family", "sans-serif")
                .attr("font-size", "11px")
                .attr("fill", "green");


            svg.append("g")
                .attr("class", "axis")
                .attr("transform", "translate(0," + (height - padding) + ")")
                .call(xAxis)
                    .selectAll("text")
                    .attr("font-family", "sans-serif")
                    .attr("font-size", "12px");

            svg.append("text")
                .attr("transform", "translate(" + (width / 2) + " ," + (height - 40) + ")")
                .style("text-anchor", "middle")
                .text("Number of prostitutions");

            svg.append("g")
                .attr("class", "axis")
                .attr("transform", "translate(" + padding + ",0)")
                .call(yAxis)
                    .selectAll("text")
                    .attr("font-family", "sans-serif")
                    .attr("font-size", "12px");

            svg.append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", 0 )
                .attr("x",0 - (height / 2))
                .attr("dy", "1em")
                .style("text-anchor", "middle")
                .text("Number of vehicle thefts");
            });
        
    
        function draw_circles(datastring,title){
            document.getElementById("title").innerHTML = "Data " + title;

            d3.csv(datastring, function(data) {
            data.forEach( function(d){
                d.District = d.District;
                d.NoPros = +d.NoPros;
                d.NoVehicle = +d.NoVehicle;
                d.Radius = +d.Radius;
            })

            //Drawing circles
            svg.selectAll("circle")
                .data(data)
                .transition()
                .duration(1000)
                .attr("r",function(d){
                    return d.Radius*2;
                 })
                .attr("cx",function(d){
                     return xScale(d.NoPros);
                 })
                .attr("cy",function(d){
                    return yScale(d.NoVehicle);
                 })
				 .attr("fill", "pink");
				 ;

            svg.selectAll("text")
                .data(data)
                .transition()
                .duration(1000)
                .text(function(d) {
                    return d.District;
                })
                .attr("x", function(d) {
                    return xScale(d.NoPros);
                })
                .attr("y", function(d) {
                    return yScale(d.NoVehicle);
                })
                .attr("font-family", "sans-serif")
                .attr("font-size", "11px")
                .attr("fill", "green");

        });  
        }  
        </script>
    </body>
</html>